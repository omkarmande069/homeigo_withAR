╔════════════════════════════════════════════════════════════════════════════╗
║              HomeGo AI Chatbot - Role-Based Access Architecture           ║
╚════════════════════════════════════════════════════════════════════════════╝

┌──────────────────────────────────────────────────────────────────────────┐
│                              USER TYPES                                  │
└──────────────────────────────────────────────────────────────────────────┘

┌─────────────┐  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐
│  👤 CUSTOMER │  │  🏪 SELLER  │  │ 👨‍💼 ADMIN   │  │ 🎧 SUPPORT  │
│  (customer)  │  │  (seller)   │  │  (admin)    │  │  (support)  │
└──────┬───────┘  └──────┬──────┘  └──────┬──────┘  └──────┬──────┘
       │                 │                 │                 │
       │                 │                 │                 │
       ▼                 ▼                 ▼                 ▼

┌──────────────────────────────────────────────────────────────────────────┐
│                           PAGE ACCESS MATRIX                             │
├──────────────────┬────────────┬─────────┬─────────┬──────────────────────┤
│ Page             │ Customer   │ Seller  │ Admin   │ Support              │
├──────────────────┼────────────┼─────────┼─────────┼──────────────────────┤
│ index.html       │     ✅     │    ❌   │   ❌    │    ❌                │
│ seller.html      │     ❌     │    ✅   │   ❌    │    ❌                │
│ admin.html       │     ❌     │    ❌   │   ✅    │    ❌                │
│ customer-support │     ✅     │    ❌   │   ❌    │    ✅                │
└──────────────────┴────────────┴─────────┴─────────┴──────────────────────┘


┌──────────────────────────────────────────────────────────────────────────┐
│                      CHATBOT INITIALIZATION FLOW                         │
└──────────────────────────────────────────────────────────────────────────┘

          ┌───────────────────────────────────┐
          │   User Opens Page                 │
          └─────────────┬─────────────────────┘
                        │
                        ▼
          ┌───────────────────────────────────┐
          │  Chatbot Script Loads             │
          │  (chatbot.js)                     │
          └─────────────┬─────────────────────┘
                        │
                        ▼
          ┌───────────────────────────────────┐
          │  Check localStorage                │
          │  for 'userSession'                │
          └─────────────┬─────────────────────┘
                        │
              ┌─────────┴─────────┐
              │                   │
              ▼                   ▼
    ┌──────────────────┐   ┌──────────────────┐
    │ Session Found    │   │ No Session       │
    │ Extract role     │   │ Treat as guest   │
    └────────┬─────────┘   └─────────┬────────┘
             │                       │
             └───────────┬───────────┘
                         │
                         ▼
          ┌───────────────────────────────────┐
          │  Compare role to allowedRoles     │
          └─────────────┬─────────────────────┘
                        │
              ┌─────────┴─────────┐
              │                   │
              ▼                   ▼
    ┌──────────────────┐   ┌──────────────────┐
    │ ✅ Authorized    │   │ ❌ Not Authorized│
    │ Initialize UI    │   │ Exit silently    │
    └──────────────────┘   └──────────────────┘


┌──────────────────────────────────────────────────────────────────────────┐
│                        TECHNICAL STACK                                   │
└──────────────────────────────────────────────────────────────────────────┘

┌─────────────────────────────────────────────────────────────────────────┐
│                           FRONTEND                                      │
├─────────────────────────────────────────────────────────────────────────┤
│  chatbot.js          → Chatbot UI & Logic                              │
│  api.js              → MongoDB API Client                              │
│  *.html              → Page Integration                                │
│  localStorage        → Session Management                              │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↕
┌─────────────────────────────────────────────────────────────────────────┐
│                           BACKEND                                       │
├─────────────────────────────────────────────────────────────────────────┤
│  server.js           → Express + MongoDB Backend                       │
│  MongoDB Atlas       → Database (products, orders, users, tickets)     │
└─────────────────────────────────────────────────────────────────────────┘
                                    ↕
┌─────────────────────────────────────────────────────────────────────────┐
│                           AI ENGINE                                     │
├─────────────────────────────────────────────────────────────────────────┤
│  Google Gemini API   → Natural Language Processing                     │
│  Context Builder     → Personalized Responses                          │
└─────────────────────────────────────────────────────────────────────────┘


┌──────────────────────────────────────────────────────────────────────────┐
│                    DATA FLOW EXAMPLE: Customer Query                     │
└──────────────────────────────────────────────────────────────────────────┘

1. Customer: "Show me available sofas"
                    │
                    ▼
2. Chatbot checks role → customer ✅
                    │
                    ▼
3. Fetch from MongoDB: API.getProducts({ category: 'furniture' })
                    │
                    ▼
4. Send to Gemini AI with context:
   - User: customer
   - Query: sofas
   - Available products: [...]
                    │
                    ▼
5. Gemini generates response with product recommendations
                    │
                    ▼
6. Display formatted response to customer


┌──────────────────────────────────────────────────────────────────────────┐
│                         SECURITY CONSIDERATIONS                          │
└──────────────────────────────────────────────────────────────────────────┘

✓ Client-side role validation (basic security)
✓ Backend API should re-validate permissions
✓ Session stored in localStorage (not secure for sensitive data)
✓ HTTPS required for production
✓ API key should be moved to backend in production
✓ CORS properly configured in server.js


┌──────────────────────────────────────────────────────────────────────────┐
│                        FILE STRUCTURE                                    │
└──────────────────────────────────────────────────────────────────────────┘

homeigo_withAR/
│
├── chatbot.js                    ← AI Chatbot (with role-based access)
├── api.js                        ← MongoDB API Client
├── server.js                     ← Backend Server
│
├── index.html                    ← Customer Homepage (customer only)
├── seller.html                   ← Seller Dashboard (seller only)
├── admin.html                    ← Admin Dashboard (admin only)
├── customer-support.html         ← Support Page (customer + support)
│
├── login.html                    ← Login (no chatbot)
├── unified-login.html            ← Unified Login (no chatbot)
│
├── CHATBOT_INTEGRATION.md        ← Full Documentation
├── CHATBOT_ACCESS_GUIDE.md       ← Quick Reference
└── CHATBOT_ARCHITECTURE.txt      ← This file


┌──────────────────────────────────────────────────────────────────────────┐
│                     DEPLOYMENT CHECKLIST                                 │
└──────────────────────────────────────────────────────────────────────────┘

□ MongoDB backend is running
□ Google Gemini API key is valid
□ User authentication sets proper roles in localStorage
□ Test all role combinations
□ Verify chatbot appears only for authorized users
□ Check CORS configuration
□ Test on different browsers
□ Mobile responsiveness check
□ API rate limits configured
□ Error handling tested


═══════════════════════════════════════════════════════════════════════════
                    HomeGo AI Chatbot Integration Complete!
═══════════════════════════════════════════════════════════════════════════
